<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.90.0" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="https://boschresearch.github.io/blech-doc/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="https://boschresearch.github.io/blech-doc/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="https://boschresearch.github.io/blech-doc/favicons/android-192x192.png" sizes="192x192">

<title>Accessing variables in the Blech environment | Blech</title>
<meta name="description" content="Access to C variables in the environment creates singleton sub-programs.
">
<meta property="og:title" content="Accessing variables in the Blech environment" />
<meta property="og:description" content="Access to C variables in the environment creates singleton sub-programs.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/env-variables/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2020-04-28T17:56:50+02:00" /><meta property="og:site_name" content="Blech" />

<meta itemprop="name" content="Accessing variables in the Blech environment">
<meta itemprop="description" content="Access to C variables in the environment creates singleton sub-programs.
">
<meta itemprop="dateModified" content="2020-04-28T17:56:50+02:00" />
<meta itemprop="wordCount" content="987">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Accessing variables in the Blech environment"/>
<meta name="twitter:description" content="Access to C variables in the environment creates singleton sub-programs.
"/>




<link rel="preload" href="https://boschresearch.github.io/blech-doc/scss/main.min.86f57cf661618458fb328abc897d2fe2c8264a081e3cac1094cb433def26ccdd.css" as="style">
<link href="https://boschresearch.github.io/blech-doc/scss/main.min.86f57cf661618458fb328abc897d2fe2c8264a081e3cac1094cb433def26ccdd.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script src=https://boschresearch.github.io/blech-doc/js/opt-in.js></script>


  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="https://boschresearch.github.io/blech-doc/">
		<span class="navbar-logo"><svg id="Ebene_1" data-name="Ebene 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 67.08 47.3"><defs><style>.cls-1{fill:#919392;stroke:#919392;stroke-linecap:round;stroke-linejoin:round}</style></defs><title>blech_grau_kontur</title><polygon class="cls-1" points="3.23 25.31 0.5 26.95 33.53 46.8 66.58 26.95 66.58 20.35 63.77 18.66 33.54 36.82 33.53 33.61 61.08 17.05 33.53 0.5 0.5 20.35 33.53 40.2 63.39 22.28 63.39 25.5 33.53 43.61 3.23 25.31"/></svg></span><span class="font-weight-bold">Blech</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="https://boschresearch.github.io/blech-doc/about/" ><span>About us</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="https://boschresearch.github.io/blech-doc/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="https://boschresearch.github.io/blech-doc/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="https://boschresearch.github.io/blech-doc/community/" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="https://boschresearch.github.io/blech-doc/research/" ><span>Research</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <input type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgetting-started-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/getting-started/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsgetting-started"><span class="">Getting Started</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsgetting-startedblechc-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/getting-started/blechc/" title="The Blech compiler - blechc" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgetting-startedblechc"><span class="">Blech compiler</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsgetting-startedvsce-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/getting-started/vsce/" title="Blech Language Services - the VS Code extension" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsgetting-startedvsce"><span class="">Blech Language Services</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsuser-manual-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/" title="The Blech language - user manual" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsuser-manual"><span class="">User manual</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualmoc-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/moc/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualmoc"><span class="">Model of execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualnotation-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/notation/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualnotation"><span class="">Notation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manuallexical-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/lexical/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manuallexical"><span class="">Lexical elements</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualstatements-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/statements/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualstatements"><span class="">Statements</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualdeclarations-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/declarations/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualdeclarations"><span class="">Declarations</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualtypes-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/types/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualtypes"><span class="">Types</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualexpressions-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/expressions/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualexpressions"><span class="">Expressions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsuser-manualmodules-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/user-manual/modules/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manualmodules"><span class="">Modules</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docslanguage-evolution-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/" title="Blech language evolution" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docslanguage-evolution"><span class="">Language Evolution</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docslanguage-evolutionblech-c-interface-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/" title="Blech&#39;s interface to C" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docslanguage-evolutionblech-c-interface"><span class="">Blech-C interface</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docslanguage-evolutionblech-c-interfaceenv-variables-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/env-variables/" title="Accessing variables in the Blech environment" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionblech-c-interfaceenv-variables"><span class="td-sidebar-nav-active-item">Environment variables</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslanguage-evolutionblech-c-interfacec-bindings-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/c-bindings/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionblech-c-interfacec-bindings"><span class="">C bindings</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslanguage-evolutionbits-and-bytes-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/bits-and-bytes/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionbits-and-bytes"><span class="">Bits and bytes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docslanguage-evolutionborrowing-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/borrowing/" title="References, borrowing and causality" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docslanguage-evolutionborrowing"><span class="">Borrowing</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docslanguage-evolutionborrowing10_references-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/borrowing/10_references/" title="References in Blech" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionborrowing10_references"><span class="">References</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docslanguage-evolutionborrowing20_borrowing-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/borrowing/20_borrowing/" title="Borrowing for references" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionborrowing20_borrowing"><span class="">Borrowing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docslanguage-evolutionborrowing30_let-ref-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/borrowing/30_let-ref/" title="Immutable references - `let ref`" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionborrowing30_let-ref"><span class="">Immutable references</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docslanguage-evolutionborrowing40_partials-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/borrowing/40_partials/" title="Partial borrowing and borrowed parts" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionborrowing40_partials"><span class="">Partials</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslanguage-evolutionmodules-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/modules/" title="Programs and modules - the Blech compilation units" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docslanguage-evolutionmodules"><span class="">Modules</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsblechc-development-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/" title="Guide to blechc development" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsblechc-development"><span class="">Blechc development</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmentconst-and-expr-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/const-and-expr/" title="Expressions, conditions, initialisers, constants" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmentconst-and-expr"><span class="">Expressions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmentpctree-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/pctree/" title="Program counter trees" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmentpctree"><span class="">PC trees</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmentexternal-vars-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/external-vars/" title="Local and external variables" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmentexternal-vars"><span class="">Variables</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmentcpdata-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/cpdata/" title="Translating Blech variable names to C" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmentcpdata"><span class="">Variable Translation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmentgit-workflow-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/git-workflow/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmentgit-workflow"><span class="">Git workflow</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsblechc-developmenttraversals-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/blechc-development/traversals/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsblechc-developmenttraversals"><span class=""></span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsexamples-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsexamples"><span class="">Blech examples</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsexamplesvirtuallock-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/virtuallock/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesvirtuallock"><span class="">Virtual Safe Lock</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsexamplesblinker-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/blinker/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesblinker"><span class="">Blinker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsexamplesstopwatch-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/stopwatch/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesstopwatch"><span class="">Stopwatch</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsexamplesreact-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/react/" title="React - a reaction test game" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesreact"><span class="">React</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-docsexamplesdcf77-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/examples/dcf77/" title="Decoding the DCF77 longwave time signal" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsexamplesdcf77"><span class="">DCF77 decoding</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontributing-li">
  <a href="https://boschresearch.github.io/blech-doc/docs/contributing/" title="Contributing to Blech development" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docscontributing"><span class="">Contributing</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/boschresearch/blech-doc/tree/master/website/content/en/docs/language-evolution/blech-C-interface/env-variables.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/boschresearch/blech-doc/edit/master/website/content/en/docs/language-evolution/blech-C-interface/env-variables.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/boschresearch/blech-doc/new/master/website/content/en/docs/language-evolution/blech-C-interface/env-variables.md?filename=change-me.md&amp;value=---%0D%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0D%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0D%0Aweight%3A&#43;100%0D%0Adescription%3A&#43;%3E-%0D%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0D%0A---%0D%0A%0D%0A%23%23&#43;Heading%0D%0A%0D%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0D%0A%0D%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0D%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0D%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0D%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0D%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/boschresearch/blech-doc/issues/new?title=Accessing%20variables%20in%20the%20Blech%20environment" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/boschresearch/blech/issues/new" class="td-page-meta--project-issue" target="_blank" rel="noopener"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
  
</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#environment-variables">Environment variables</a></li>
    <li><a href="#external-read-write-c-variables-create-singletons">External read-write C variables create singletons</a></li>
    <li><a href="#singletons-and-separate-compilation">Singletons and separate compilation</a></li>
    <li><a href="#the-diamond-call-problem">The diamond call problem</a></li>
    <li><a href="#structured-access-to-external-variables">Structured access to external variables</a></li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://boschresearch.github.io/blech-doc/docs/">Documentation</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/">Language Evolution</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/">Blech-C interface</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://boschresearch.github.io/blech-doc/docs/language-evolution/blech-c-interface/env-variables/">Environment variables</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Accessing variables in the Blech environment</h1>
	<div class="lead">Access to C variables in the environment creates singleton sub-programs.</div>
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
	</header>    
	<h2 id="environment-variables">Environment variables</h2>
<p>Environment variables are either read-only inputs or read-write outputs.
Every environment variables has a counterpart in the Blech environment.
Therefore, they are annotated as <code>@[CInput ...]</code> or <code>@[COutput ...]</code>.
Environment variables are classified by the keyword <code>extern</code>. 
A <code>extern let</code> definition must be annotated with a <code>@[CInput ...]</code>.
An <code>extern var</code> definition must be annotated with a <code>@[COutput ...]</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">@[CInput (binding = &#34;theSensor&#34;, header = &#34;sensors.h&#34;)]
extern let sensor: uint8 

@[COutput (binding = &#34;spiIsReady&#34;, header = &#34;spi.h&#34;)]
extern var spiReady: bool
</code></pre></div><p>Since the external C variables bound to the environment variables live in the environment they do not follow the synchronous semantics. 
They might be <code>volatile</code> changing their value during a reaction. 
They might be read or written asynchronously by the environment.</p>
<p>In order to synchronize these C variables, the Blech program holds a buffered value of the external value in the environment variable.</p>
<p>The Blech runtime system takes care of the synchronisation.
Before the reaction, the values of all external C variables are copied into the environment variable.
After the reaction, the values of the <code>extern var</code> variables are copied into the external C variables.</p>
<p>The implementation is allowed to distribute these copying operations into the code generated for each activity, that defines <code>extern</code> variables.</p>
<p>Environment variables can only be declared in an <code>activity</code>.
Functions can only access environment variables via the parameter list.</p>
<h2 id="external-read-write-c-variables-create-singletons">External read-write C variables create singletons</h2>
<p>An external C variable is a global variable, which is in danger to be accessed concurrently via the environment variable.
While Blech in general prevents this danger by not allowing the declaration of global variables at all, it needs more effort to guarantee this for external C variables.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">activity handleCVariables()
    
    @[CInput (binding = &#34;theSensor&#34;, header = &#34;sensors.h&#34;)]
    extern let sensor: uint8
    @[COutput (binding = &#34;spiIsReady&#34;, header = &#34;spi.h&#34;)]
    extern var spiReady: bool

    repeat
        if sensor &gt; 10 then
            spiReady = true
        end
        await true
    end
end
</code></pre></div><p>In order to comply to the single-writer principle, declaring an <code>extern var</code> variable in an activity restricts this activity to be instantiated only once.
The declared activity is a <code>singleton</code> and does not allow multiple instances.
An singleton activity cannot be called concurrently, but only sequentially.
Note that this is only necessary for <code>extern var</code> declarations.
An <code>extern let</code> variable does <em>not</em> create a <code>singleton</code>.
Different instances of such an activity can have separate buffers of the external C variable, which might have different values in the same reaction if the external C variable is <code>volatile</code>.
It is the responsibility of the programmer not to share external C variables in different <code>extern var</code> declarations.
Two or more <code>extern let</code> declarations are allowed to have the same annotation <code>@[CInput ...]</code>.</p>
<h2 id="singletons-and-separate-compilation">Singletons and separate compilation</h2>
<p>If a module exports a singleton activity, the signature needs to reflect this in order to enable a correct causality analysis.
The signature for the above activity <code>handleCVariables</code> looks like the following</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">singleton handleCVariables.spiReady 
activity handleCVariables()
</code></pre></div><p>It shows the activities prototype, exposes the unique names of the external variables and shows their annotations. 
Showing the annotations allows to check the binding to C variables also for modules where the implementation is hidden.</p>
<h2 id="the-diamond-call-problem">The diamond call problem</h2>
<p>If an activity is a singleton, it still can be called from several activities.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">activity firstUsage()
    run handleCVariables()
end

activity secondUsage()
    run handleCVariables()
end
</code></pre></div><p>Again <code>firstUsage</code> and <code>secondUsage</code> can not be called concurrently.</p>
<p>In order to check this via the signature, the calling activities, inherits the singletons from the called activity.
In a module signature these activities occur as follows</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">singleton handleCVariables.spiReady
activity firstUsage()

singleton handleCVariables.spiReady
activity secondUsage()

</code></pre></div><p>If we combine activities with different singletons, they must not be called concurrently, if they share common singletons.
For example assume the following module signature.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">signature Module 

singleton handleOtherCVariable.theExternVar
activity handleOtherCVariable()
</code></pre></div><p>A calling activity might inherit all singletons</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import Module

activity thirdUsage()
    cobegin
        run handleCVariables()
    with
        run handleOtherCVariable()
    end
end
</code></pre></div><p>The deduced signature is</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import Module

singleton handleCVariables.spiReady, 
          Module.handleOtherCVariable.theExternVar
activity thirdUsage()
</code></pre></div><p>Activity <code>thirdUsage</code> cannot be called concurrently to <code>firstUsage</code> or <code>secondUsage</code> because their singletons overlap.</p>
<h2 id="structured-access-to-external-variables">Structured access to external variables</h2>
<p>Environment variables can also be referenced from a <code>struct</code> type, like normal Blech variables.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">struct MyCVariables
    var x: int32
    let ref sensor: nat8
    var ref spiReady: bool
end
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">activity referToCVariables()
    @[CInput (binding = &#34;theSensor&#34;, header = &#34;sensors.h&#34;)]
    extern let sensor: nat8 

    @[COutput (binding = &#34;spiIsReady&#34;, header = &#34;spi.h&#34;)]
    extern var spiReady: bool

    var mcvs: MyCVariables = { x = 0, sensor = sensor, spiReady = spiReady }
end
</code></pre></div><p>If we use both activities <code>referToCVariables</code> and <code>handleCVariables</code> in a Blech program we obviously made a mistake.
Both activities write to the same external C Variable <code>&quot;spiIsReady&quot;</code>.
The single-writer principle is broken.
The semantics of the program is undefined concerning the environment access.
In general working with externals is unsafe.
In this particular case, it is the responsibility of the programmer to take care, not to share the same <code>COutput</code> between different <code>extern var</code> declarations.</p>
<p>The signatures of both activities cannot reveal this error.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">singleton referToCVariables.spiReady
activity referToCVariables()

singleton handleCVariables.spiReady
activity handleCVariables()
</code></pre></div><p>Idea: It should be the responsibility. of the compiler to collect the environment of a Blech program across all modules in order to allow for a code review supported by such a description file.</p>
<p>Hints: <code>extern var</code> and <code>extern let</code> declarations cannot be declared inside functions.
Use <code>extern let</code> declarations when possible in order to prevent the propagation of the singleton property.</p>
<p>Since signatures are deduced by the compiler, the whole checking of singletons and the generation of appropriate signatures is done by the compiler.</p>
<p>Note: A conventional embedded program is full of singletons, not only created by <code>extern var</code> declarations, but especially by global variables.
In order to maintain the single-writer principle by programming discipline it is almost inevitable, that all functions are only called once in a task list. This makes reuse and testing extremely difficult. Only the rather small number of services is reusable and rather easily testable.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified April 28, 2020: <a href="https://github.com/boschresearch/blech-doc/commit/5efeab316195474664991bc95865fcc2ce4a51c1">Updates on language evolution (5efeab3)</a>
</div>

</div>


          </main>
        </div>
      </div>
      


<div class="analytics-opt-in">
    <div class="text">
        <p>If you opt-in, we use cookies to improve your experience on our site. <a href="https://boschresearch.github.io/blech-doc/about/">Find out more.</a>
        </p>
    </div>  
    <div class="buttons">
        
        <a class="ok btn-sm btn-primary" onclick="optIn()">Opt-in</a>
        <a class="close" onclick="closeNotice()">&times</a>
    </div>
</div>

<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="The Blech mailing list" aria-label="The Blech mailing list">
    <a class="text-white" target="_blank" href="https://groups.google.com/d/forum/blech-lang">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter @BlechLanguage" aria-label="Twitter @BlechLanguage">
    <a class="text-white" target="_blank" href="https://twitter.com/BlechLanguage">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Documentation on GitHub" aria-label="Documentation on GitHub">
    <a class="text-white" target="_blank" href="https://github.com/boschresearch/blech-doc">
      <i class="fas fa-book"></i>
    </a>
  </li>
  
</ul>

        
        
        <h6 class="text-white">Blech users</h6>
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Blech compiler on Github" aria-label="Blech compiler on Github">
    <a class="text-white" target="_blank" href="https://github.com/boschresearch/blech">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Blech tools on Github" aria-label="Blech tools on Github">
    <a class="text-white" target="_blank" href="https://github.com/boschresearch/blech-tools">
      <i class="fas fa-tools"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Collaborate on Slack" aria-label="Collaborate on Slack">
    <a class="text-white" target="_blank" href="https://join.slack.com/t/blech-lang/shared_invite/enQtODkyMDg4MDQ2Mjc2LWZjZWI1MmE2NTNhOGU0ZTVmMGEzMzY1ODlmNzBlMDFhMTIwMDRlZDA1MmU2NjY2OTFlZTA1NWIwMzU3NThkY2I">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
        <h6 class="text-white">Blech developers</h6>
      </div>
      
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2019-2022 The Blech contributors</small>
        
        <small class="ml-1"><a href="https://boschresearch.github.io/blech-doc/about/privacy-policy/" style="color: skyblue" target="_blank">Privacy Policy</a></small>
        
          <p class="mt-2"><a href="https://boschresearch.github.io/blech-doc/about/corporate-information/" style="color: skyblue">Corporate information</a></p>
        
      </div>
      
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='https://boschresearch.github.io/blech-doc/js/tabpane-persist.js'></script>


















<script src="https://boschresearch.github.io/blech-doc/js/main.min.602773ee633d7e2783afada8c31019df4b639c23a2ae03c6139b6530b7f411d4.js" integrity="sha256-YCdz7mM9fieDr62owxAZ30tjnCOirgPGE5tlMLf0EdQ=" crossorigin="anonymous"></script>




  </body>
</html>